---
import ThemeToggle from "../ThemeToggle.astro";

const url = new URL(Astro.request.url);

const menuLinks = [
	{
		title: "Projects",
		path: "/posts/projects",
	},
	{
		title: "Writing",
		path: "/posts",
	},
	{
		title: "What I use?",
		path: "/posts/what-i-use",
	},
];
---

<script>
	import { toggleClass } from "@/utils";

	document.addEventListener("DOMContentLoaded", () => {
		const header = document.getElementById("main-header") as HTMLElement;
		const toggleMenuButton = document.getElementById("toggle-navigation-menu") as HTMLButtonElement;
		let menuOpen = false;

		toggleMenuButton.addEventListener("click", () => {
			toggleClass(header, "menu-open");
			menuOpen = !menuOpen;
			toggleMenuButton.setAttribute("aria-expanded", menuOpen.toString());
		});
	});
</script>

<header id="main-header" class="group relative mb-28 flex items-center sm:pl-[4.5rem]">
	<div class="flex sm:flex-col">
		<a
			href="/"
			class="inline-flex items-center grayscale hover:filter-none sm:relative sm:inline-block"
			aria-current={url.pathname === "/" ? "page" : false}
		>
			<svg
				class="mr-3 h-10 w-6 sm:absolute sm:left-[-4.5rem] sm:mr-0 sm:h-20 sm:w-12"
				aria-hidden="true"
				focusable="false"
				fill="none"
				xmlns="http://www.w3.org/2000/svg"
				viewBox="0 0 80 140"
			>
				<title>Logo</title>
				<path
					d="M52.0374 15.992C44.5915 15.992 38.4993 18.6996 33.7609 24.1149C29.0225 29.5302 26.6533 36.13 26.6533 43.9145V70.5678C26.6533 73.1063 25.3841 74.3755 22.8457 74.3755C20.3073 74.3755 19.0381 73.1063 19.0381 70.5678V43.9145C19.0381 36.3839 20.9419 29.6147 24.7495 23.6072C28.5571 17.5996 33.4225 13.3689 39.3454 10.9152C26.6533 8.71518 14.8074 7.61524 3.80762 7.61524C1.2692 7.61524 0 6.34603 0 3.80762C0 1.26921 1.2692 0 3.80762 0C16.9228 0 32.9993 1.94605 52.0374 5.83835C53.0528 6.00751 53.9413 6.59987 54.7028 7.61524C55.4643 8.54592 55.8451 9.64596 55.8451 10.9152C55.8451 12.1844 55.422 13.3689 54.5759 14.4689C53.7298 15.4843 52.8835 15.992 52.0374 15.992Z"
					fill="#DFD2A6"></path>
				<path
					d="M36.3261 103.571C34.0586 103.293 32.9535 101.878 33.0109 99.3273C33.1272 94.9089 32.7792 84.5509 31.967 68.254C31.2285 52.0512 31.0707 42.2282 31.4935 38.785C32.2771 32.4022 35.8928 27.6034 42.3402 24.3883C48.7876 21.1731 55.7066 20.0194 63.0971 20.9268C68.64 21.6074 72.9794 23.7599 76.1147 27.3843C79.25 31.0088 80.4875 35.5085 79.8281 40.8834C79.4364 44.0748 78.1514 46.9007 75.9739 49.3613C73.8797 51.8323 71.4811 53.6689 68.7755 54.8713C62.9881 57.5706 58.2888 58.6986 54.6776 58.2552C52.158 57.9458 51.053 56.5313 51.3624 54.0119C51.6407 51.7443 53.05 50.6813 55.5901 50.8227C58.2245 50.8904 61.5389 49.9334 65.5332 47.9515C69.6115 45.9801 71.8519 43.3567 72.2535 40.0813C72.666 36.722 71.968 34.0788 70.1585 32.1517C68.3595 30.1405 65.2765 28.8668 60.9093 28.3306C56.6261 27.8047 52.0204 28.518 47.092 30.4703C42.2475 32.4329 39.5881 35.3459 39.1138 39.2091C38.6395 43.0723 38.9079 55.4664 39.9191 76.3913L42.3256 68.2472C43.0549 65.7793 44.4694 64.6742 46.569 64.932C49.0884 65.2414 50.1935 66.6557 49.8842 69.1752C49.8326 69.5951 49.7338 70.052 49.588 70.5455L40.9473 100.302C40.7705 101.048 40.2946 101.799 39.5196 102.557C38.7344 103.398 37.6698 103.736 36.3261 103.571Z"
					fill="#DFD2A6"></path>
			</svg>
			<span class="text-xl font-bold sm:text-2xl">Thuan Pham</span>
		</a>
		<nav
			id="navigation-menu"
			class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-[color:var(--theme-menu-bg)] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:mt-1 sm:-ml-4 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
			aria-label="Main menu"
		>
			{
				menuLinks.map((link) => (
					<a
						href={link.path}
						class="py-4 px-4 sm:py-0 sm:hover:underline"
						aria-current={url.pathname === link.path ? "page" : false}
						rel="prefetch"
					>
						{link.title}
					</a>
				))
			}
		</nav>
	</div>
	<ThemeToggle />
	<button
		id="toggle-navigation-menu"
		class="group relative ml-8 h-7 w-7 sm:invisible sm:hidden"
		type="button"
		aria-label="Open main menu"
		aria-expanded="false"
		aria-haspopup="menu"
	>
		<svg
			id="line-svg"
			class="absolute top-1/2 left-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
			aria-hidden="true"
			focusable="false"
			xmlns="http://www.w3.org/2000/svg"
			fill="none"
			viewBox="0 0 24 24"
			stroke-width="1.5"
			stroke="currentColor"
			data-hide="true"
		>
			<path stroke-linecap="round" stroke-linejoin="round" d="M3.75 9h16.5m-16.5 6.75h16.5"></path>
		</svg>
		<svg
			id="cross-svg"
			class="absolute top-1/2 left-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
			class="text-accent"
			aria-hidden="true"
			focusable="false"
			xmlns="http://www.w3.org/2000/svg"
			fill="none"
			viewBox="0 0 24 24"
			stroke-width="1.5"
			stroke="currentColor"
		>
			<path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path>
		</svg>
	</button>
</header>
